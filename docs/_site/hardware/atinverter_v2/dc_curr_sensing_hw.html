<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(10)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > ul > li:nth-child(10) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > ul > li:nth-child(10) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(10) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>DC Current Sensing | Atinverter Docs</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="DC Current Sensing" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A comprehensive documentation detailing how to use the Atinverter" /> <meta property="og:description" content="A comprehensive documentation detailing how to use the Atinverter" /> <link rel="canonical" href="http://localhost:4000/hardware/atinverter_v2/dc_curr_sensing_hw.html" /> <meta property="og:url" content="http://localhost:4000/hardware/atinverter_v2/dc_curr_sensing_hw.html" /> <meta property="og:site_name" content="Atinverter Docs" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="DC Current Sensing" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A comprehensive documentation detailing how to use the Atinverter","headline":"DC Current Sensing","url":"http://localhost:4000/hardware/atinverter_v2/dc_curr_sensing_hw.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Atinverter Docs </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/vision.html" class="nav-list-link">Vision</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Hardware category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/hardware/hardware.html" class="nav-list-link">Hardware</a><ul class="nav-list"><li class="nav-list-item"><a href="/hardware/a_v1_hw.html" class="nav-list-link">Atinverter V1 Hardware</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Atinverter V2 Hardware category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/hardware/atinverter_v2/a_v2_hw.html" class="nav-list-link">Atinverter V2 Hardware</a><ul class="nav-list"><li class="nav-list-item"><a href="/hardware/atinverter_v2/ov_reset_prot_hw.html" class="nav-list-link">OV and Reset Protection</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/buck_conv_hw.html" class="nav-list-link">Buck Converter</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/power_inverter_hw.html" class="nav-list-link">Power Inverter</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/boost_conv_hw.html" class="nav-list-link">Boost Converter</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/LED_blinking_hw.html" class="nav-list-link">LED Blinking</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/dc_volt_sensing_hw.html" class="nav-list-link">DC Voltage Sensing</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/ac_volt_sensing_hw.html" class="nav-list-link">AC Voltage Sensing</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/ac_curr_sensing_hw.html" class="nav-list-link">AC Current Sensing</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/inter_board_comms.html" class="nav-list-link">Inter-Board Communication</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/dc_curr_sensing_hw.html" class="nav-list-link">DC Current Sensing</a></li><li class="nav-list-item"><a href="/hardware/atinverter_v2/experimentation.html" class="nav-list-link">Experimentation</a></li></ul></li><li class="nav-list-item"><a href="/hardware/ST_HW.html" class="nav-list-link">St. Thomas Inverter Specs</a></li><li class="nav-list-item"><a href="/hardware/power_rating.html" class="nav-list-link">Atinverter V1/2 Power Rating</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Software category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/software/software.html" class="nav-list-link">Software</a><ul class="nav-list"><li class="nav-list-item"><a href="/software/a_v1_sw.html" class="nav-list-link">Atinverter V1 Software</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Atinverter V2 Software category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/software/a_v2_sw.html" class="nav-list-link">Atinverter V2 Software</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Library category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/software/library/library.html" class="nav-list-link">Library</a><ul class="nav-list"><li class="nav-list-item"><a href="/software/library/library_reference.html" class="nav-list-link">Reference</a></li><li class="nav-list-item"><a href="/software/library/library_setup.html" class="nav-list-link">Set Up</a></li><li class="nav-list-item"><a href="/software/library/library_uml.html" class="nav-list-link">UML Diagram</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Features category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/software/library/features/library_features.html" class="nav-list-link">Features</a><ul class="nav-list"><li class="nav-list-item"><a href="/software/library/features/blink_feature.html" class="nav-list-link">Blink</a></li><li class="nav-list-item"><a href="/software/library/features/dc_vi_sensing_feature.html" class="nav-list-link">DC V/I Sensing</a></li><li class="nav-list-item"><a href="/software/library/features/ac_vi_sensing_feature.html" class="nav-list-link">AC V/I Sensing</a></li><li class="nav-list-item"><a href="/software/library/features/pwm_inversion_feature.html" class="nav-list-link">PWM Inversion</a></li><li class="nav-list-item"><a href="/software/library/features/timer2_delay_feature.html" class="nav-list-link">Timer 2 Delay</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Modules category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/software/modules/modules.html" class="nav-list-link">Modules</a><ul class="nav-list"><li class="nav-list-item"><a href="/software/modules/blink_module.html" class="nav-list-link">Blink</a></li><li class="nav-list-item"><a href="/software/modules/main_module.html" class="nav-list-link">Main</a></li><li class="nav-list-item"><a href="/software/modules/pwm_inversion_module.html" class="nav-list-link">PWM Inversion</a></li><li class="nav-list-item"><a href="/software/modules/dc_vi_sensing_module.html" class="nav-list-link">DC V/I Sensing</a></li><li class="nav-list-item"><a href="/software/modules/ac_vi_sensing_module.html" class="nav-list-link">AC V/I Sensing</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="/scratchpad.html" class="nav-list-link">Scratchpad</a></li><li class="nav-list-item"><a href="/todo.html" class="nav-list-link">To-Do</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Atinverter Docs" aria-label="Search Atinverter Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/just-the-docs/just-the-docs-template" class="site-button" > Template Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/hardware/hardware.html">Hardware</a></li> <li class="breadcrumb-nav-list-item"><a href="/hardware/atinverter_v2/a_v2_hw.html">Atinverter V2 Hardware</a></li> <li class="breadcrumb-nav-list-item"><span>DC Current Sensing</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <!-- To enable math equation formatting --> <p><!-- Polyfill for older browsers (optional) --> <script type="text/javascript" async="" src="https://polyfill.io/v3/polyfill.min.js?features=es6"> </script></p> <p><!-- MathJax v3 for LaTeX rendering --> <script type="text/javascript" async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script></p> <p><!-- Custom MathJax Configuration --> <script type="text/javascript"> MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], } }; </script></p> <h1 id="dc-current-sensing-hardware"> <a href="#dc-current-sensing-hardware" class="anchor-heading" aria-labelledby="dc-current-sensing-hardware"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>DC Current Sensing Hardware</strong> </h1> <hr /> <p>The current at the input of the power inverter is measured using a Hall-effect current sensor which leverages its electromagnetic properties to perform an isolated, low resistive measurement. After passing through the series connected sensor, it is then delivered to the supply rails of the H-bridge where it continues standard PWM inversion operation. <br /> <br /></p> <p align="center"> <img src="../../images/DC_current_sensing_block_diagram.png" alt="AC Current Sensing Block Diagram" width="800" /> </p> <div style="text-align: center;"> <h7> <b>Figure X.</b> DC Current Sensing Block Diagram </h7> </div> <h2 id="hall-effect-theory"> <a href="#hall-effect-theory" class="anchor-heading" aria-labelledby="hall-effect-theory"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hall-Effect Theory </h2> <p>To understand Hall-effect current sensors, it is useful to have an understanding of the two fundamental laws of electromagnetism:</p> <ol> <li>Lorentz Force Law</li> <li>Ampere’s Law</li> </ol> <p>Instead of merely defining the laws, this section examines how they manifest themselves in the operation of the device.</p> <p>Consider a conductive element where a current flows. The yellow balls represent electrons that are evenly distributed when flowing through a conductor. The current flow is denoted as “I”.</p> <p>Ampere’s law gives rise to a magnetic field generated around the conductor in accordance with the right-hand rule and it is proportional to the current that is flowing. Additionally, if an external magnetic field is applied near the conductor (strongest when perpendicular due to Lorentz force), the electrons will be deflected and accumulate in one area leaving the opposite side with a net positive charge. The charge separation between both ends can be measured — known as the hall-voltage.</p> <p align="center"> <img src="../../images/hall_effect_transparent_background.png" alt="Hall Effect Diagram" width="500" /> </p> <div style="text-align: center;"> <h7> <b>Figure X.</b> (a) Uniform Electron Distribution in a Current-Carrying Conductor <br /> <span style="margin-left: 110px;">(b) Electron Accumulation Due to Lorentz Force Under a Magnetic Field </span> </h7> </div> <h2 id="tmcs1108-current-sensor"> <a href="#tmcs1108-current-sensor" class="anchor-heading" aria-labelledby="tmcs1108-current-sensor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TMCS1108 Current Sensor </h2> <p>In this design, the Hall-effect current sensor of choice is the <strong>TMCS1108</strong>. It internally measures the hall-voltage and amplifies it to produce an <strong>analog voltage output which is proportional to the sensed current</strong>. This analog voltage can be calculated using the <a href="https://www.ti.com/lit/ds/symlink/tmcs1108.pdf?HQS=dis-dk-null-digikeymode-dsf-pf-null-wwe&amp;ts=1744785799224">TMCS1108 datasheet</a> provided equation in page 12:</p> \[V_{OUT} = S \times I_{IN} + V_{OUT,0A}\] <p>where:</p> <ul> <li>$V_{OUT}$ is the analog output voltage.</li> <li>S is the ideal sensitivity of the device.</li> <li>$I_{IN}$ is the isolated input current.</li> <li>$V_{OUT,0A}$ is the zero current output voltage for the device variant.</li> </ul> <p>As this design employs the <strong>TMCS1108A4BQDR</strong> device variant, this features a sensitivity of 400mV/A. This describes the relation between the output analog voltage and current input where the output changes 400mV for every 1A of detected current. Higher sensitivities are generally favorable, as they result in a greater voltage response per unit of current.</p> <p>The non-zero current output is due to the device bidirectionality of the sensor, where the output is centered at mid-supply as noted in page 3 of the <a href="https://www.ti.com/lit/ds/symlink/tmcs1108.pdf?HQS=dis-dk-null-digikeymode-dsf-pf-null-wwe&amp;ts=1744785799224">TMCS1108 datasheet</a>.</p> \[V_{OUT,0A} = 0.5 × V_{S}\] <p>where:</p> <ul> <li>$V_{OUT,0A}$ is the zero current output voltage for the device variant.</li> <li>$V_{S}$ is the supply voltage to the chip.</li> </ul> <p>Since the chip is powered by a 5V supply, at no current input, the output analog voltage resides at 2.5V. For positive current, the output voltage increases above 2.5V and conversely for negative current, the output decreases below 2.5V.</p> <p>The analog output voltage is then measured by the analog pin of our ATMEGA328P, where it is converted to a digital value between the range of 0-1023. After the MCU has an understanding of what the voltage signal is in the digital domain, the current for the DC input is computed using a restructured form of the previous equation.</p> \[I_{IN} = \frac{V_{OUT} - V_{OUT,0A}}{S}\] <p>This conversion ultimately produces an accurate current reading based on the previously discussed hall-effect phenomenon and fulfills the goal of measuring the DC input current of the Atinverter V2 device.</p> </main> </div> </div> <div class="search-overlay"></div> </div> <script type="module"> import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.esm.min.mjs'; var config = {} ; mermaid.initialize(config); mermaid.run({ querySelector: '.language-mermaid', }); </script> </body> </html>
